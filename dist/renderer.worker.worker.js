(()=>{"use strict";var e={904:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AssertLessOrEqualThanError=t.AssertLessThanError=t.AssertGreaterOrEqualThanError=t.AssertGreaterThanError=t.AssertIntegerError=t.AssertError=t.assertLessOrEqualThan=t.assertLessThan=t.assertGreaterOrEqualThan=t.assertGreaterThan=t.assertInteger=void 0,t.assertInteger=function(e){if(!Number.isInteger(e))throw new s},t.assertGreaterThan=function(e,t){if(e<=t)throw new a},t.assertGreaterOrEqualThan=function(e,t){if(e<t)throw new n},t.assertLessThan=function(e,t){if(e>=t)throw new o},t.assertLessOrEqualThan=function(e,t){if(e>t)throw new i};class r extends Error{}t.AssertError=r;class s extends r{}t.AssertIntegerError=s;class a extends r{}t.AssertGreaterThanError=a;class n extends r{}t.AssertGreaterOrEqualThanError=n;class o extends r{}t.AssertLessThanError=o;class i extends r{}t.AssertLessOrEqualThanError=i},469:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const s=r(904),a=r(629);class n{constructor(e,t,r){this.red=e,this.green=t,this.blue=r,(0,s.assertGreaterOrEqualThan)(e,0),(0,s.assertGreaterOrEqualThan)(t,0),(0,s.assertGreaterOrEqualThan)(r,0),(0,s.assertLessOrEqualThan)(e,255),(0,s.assertLessOrEqualThan)(t,255),(0,s.assertLessOrEqualThan)(r,255);const a=e=>1===e.length?"0"+e:e;this.hex="#"+a(this.red.toString(16))+a(this.green.toString(16))+a(this.blue.toString(16))}getRed(){return this.red}getGreen(){return this.green}getBlue(){return this.blue}mix(e,t){return new n(Math.round(this.red*t+e.getRed()*(1-t)),Math.round(this.green*t+e.getGreen()*(1-t)),Math.round(this.blue*t+e.getBlue()*(1-t)))}toHexFormat(){return this.hex}equals(e){return this.blue===e.getBlue()&&this.red===e.getRed()&&this.green===e.getGreen()}toArray(){return[this.red,this.green,this.blue]}static random(){return new n((0,a.randomInt)(0,255),(0,a.randomInt)(0,255),(0,a.randomInt)(0,255))}static fromHex(e){return e.startsWith("#")&&(e=e.slice(1)),new n(parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16))}}t.Color=n},629:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.randomInt=void 0,t.randomInt=function(e,t){const r=t-e+1;return Math.floor(Math.random()*r)+e}},415:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommonRenderer=void 0;const s=r(469),a=s.Color.fromHex("#000000"),n=s.Color.fromHex("#ffffff"),o=s.Color.fromHex("#F8CB2E"),i=s.Color.fromHex("#2155CD"),h=s.Color.fromHex("#F0E9D2"),l={default:null,lifetime:"lifetime",energy:"energy"};t.CommonRenderer=class{constructor(){}render(e,t,r,s,d,u,g){return new Promise((c=>{const f=g.getArray(),m=g.getPayload(),E=m.indexOf(l[u])+1;this.empty&&this.empty.width===e&&this.empty.height===t||(this.empty=new ImageData(new Uint8ClampedArray(e*t*4).map(((e,t)=>t%4==3?255:0)),e,t));const T=new ImageData(new Uint8ClampedArray(this.empty.data),e,t),w=(t,r,s)=>{const a=[];let n=d,o=d;t<0&&(n+=t,t=0),r<0&&(o+=r,r=0),t+d>=T.width&&(n=T.width-t),r+d>=T.height&&(o=T.height-r);for(let e=0;e<n;e++)a.push(s[0],s[1],s[2],255);const i=4*t,h=4*e;for(let e=0;e<o;e++)T.data.set(a,h*(r+e)+i)};let y=0;for(let e=0;e<g.getWidth();e++)for(let t=0;t<g.getHeight();t++){const l=r+e*d;if(l+d<0||l>=T.width){y+=m.length+1;continue}const g=s+t*d;if(g+d<0||g>=T.height)y+=m.length+1;else{switch(f[y]){case 0:case 3:break;case 1:let e;e="energy"===u?o.mix(a,f[y+E]/100):"lifetime"===u?a.mix(n,f[y+E]/100):i,w(l,g,e.toArray());break;case 2:w(l,g,h.toArray())}y+=m.length+1}}c(T)}))}}},158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Data=void 0;const r={empty:0,organism:1,organic:2,wall:3},s={NORTH:0,NORTH_EAST:1,NORTH_WEST:2,SOUTH:3,SOUTH_EAST:4,SOUTH_WEST:5,EAST:6,WEST:7};class a{constructor(e,t,r,s){this.array=e,this.payload=t,this.width=r,this.height=s}static create(e,t){const n=e.getGrid(),o=n.getWidth(),i=n.getHeight(),h=new Uint8Array(o*i*(t.length+1));let l=0;for(let e=0;e<o;e++)for(let a=0;a<i;a++){const o=n.getCell(e,a);h[l]=r[o.getType()],o.visit({visitEmpty:()=>{l+=t.length+1},visitOrganic:()=>{l+=t.length+1},visitWall:()=>{l+=t.length+1},visitOrganism:e=>{for(const r of t)switch(r){case"direction":h[++l]=s[e.getDirection()];break;case"energy":h[++l]=e.getEnergy();break;case"lifetime":h[++l]=e.getLifetime();break;default:throw new Error}l++}})}return new a(h,t,o,i)}getArray(){return this.array}getPayload(){return this.payload}getWidth(){return this.width}getHeight(){return this.height}}t.Data=a}},t={};function r(s){var a=t[s];if(void 0!==a)return a.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}(()=>{const e=r(158),t=r(415),s=self,a=new t.CommonRenderer;let n=[];setTimeout((function t(){if(n.length){const t=n.pop();n=[];const r=new e.Data(t.data.array,t.data.payload,t.data.width,t.data.height);a.render(t.width,t.height,t.offsetX,t.offsetY,t.scale,t.mode,r).then((function(e){s.postMessage({id:t.id,data:e},[e.data.buffer])}))}setTimeout(t,0)}),0),s.addEventListener("message",(e=>{n.push(e.data)}))})()})();